# 驱动当中如何获取系统层的文件

在TP驱动当中，经常能看到有些fw文件放置/vendor/etc/firmware/目录下，然后驱动加载过程中需要读取这些fw文件，然后驱动更新这些fw文件。

1.在老版本的驱动当中有vfs_read（）这个接口，但是在linux5.4及以上版本内核当中，这个函数就被废弃了，可以采用 kernel_read()来替代。

还有一种更加好用的函数就是request_firmware（）这个是内核封装的一套标准机制。文件的获取路径在cmdline中定义了，对应firmware_class.path的值。
B810当中android/device/softwinner/epic/epic-aw/BoardConfig.mk中BOARD_KERNEL_CMDLINE += firmware_class.path=/vendor/etc/firmware 来进行配置的。
注意因为/vendor分区的加载是在内核运行之后，所以驱动最好是加载成ko运行，否则的话这几个函数是无法获取到文件的。

